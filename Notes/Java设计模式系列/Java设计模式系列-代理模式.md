# Java设计模式系列-代理模式
## 一、概述
代理模式算是我接触较早的模式，代理就是中介，中间人。法律上也有代理，比如代理律师之类，委托人将自己的一部分权限委托给代理者，代理者就拥有被代理者（委托人）的部分权限，并且可以以被代理人的名义来实行这些权限，此时代理者与委托人等同，当然代理人也可以在实行权限时配合自己的能力来进行，当然不能超出这个权限。
  
Java中的代理模式类似于上面的代理，我们也是为一个类（委托类）创建一个代理类，来代表它来对外提供功能。
  
如何在Java中创建一个类的代理类呢？
  
很简单，我们需要创建一个公共接口，委托类要实现这个接口，再创建一个接口的实现类作为代理类，在这个类中的方法中可以直接调用委托类中的同名方法，外部类要进行访问时，可以使用接口指向代理类实例，调用代理类中的方法，从而间接调用委托类中的具体方法实现。
## 二、示例
我们就以法律上的委托代理为例来写个实例：
  
总接口：ZiRanRen
```java
public interface ZiRanRen {
    void Quanli();
}
```
委托人：MaYun
```java
public class MaYun implements ZiRanRen {
    public void eat() {
        System.out.println("今天吃满汉全席");
    }
    public void drink() {
        System.out.println("今天喝大西洋");
    }
    @Override
    public void Quanli() {
        System.out.println("我赋予我的代理律师来行使这些权利,此时代理律师全权代理我处理某些事务");
    }
}
```
代理律师：LvShi
```java
public class LvShi implements ZiRanRen {
    @Override
    public void Quanli() {
        new MaYun().Quanli();
    }
}
```
测试类：Clienter
```java
public class Clienter {
    public static void main(String[] args) {
        ZiRanRen ls = new LvShi();
        ls.Quanli();
    }
}
```
执行结果：
```text
我赋予我的代理律师来行使这些权利,此时代理律师全权代理我处理某些事务
```
## 三、模式解析
上面是一个很简单的例子，可以看出，我们想对外开放某些功能，就可以将这些功能在代理类中被引用，如此一来，屏蔽了我们不想外露的功能，只将我们想开放的功能开放出来。亦即委托类中其实是可以有很多方法的，很多功能的，我们可以酌情对外开放，代理类犹如一道大门，将委托类与外部调用者隔绝开来，只将部分功能赋予这个大门，来代替委托类行使这个功能，哪怕最终还是要牵扯到自身（因为最终还是要调用委托类的对应方法实现）。
  
代理模式很简单，只要记住以下关键点，简单易实现：
- 代理类与委托类实现同一接口
- 在委托类中实现功能，在代理类的方法中中引用委托类的同名方法
- 外部类调用委托类某个方法时，直接以接口指向代理类的实例，这正是代理的意义所在：屏蔽。
## 四、使用场景
代理模式场景描述：
- 当我们想要隐藏某个类时，可以为其提供代理类
- 当一个类需要对不同的调用者提供不同的调用权限时，可以使用代理类来实现（代理类不一定只有一个，我们可以建立多个代理类来实现，也可以在一个代理类中金进行权限判断来进行不同权限的功能调用）
- 当我们要扩展某个类的某个功能时，可以使用代理模式，在代理类中进行简单扩展（只针对简单扩展，可在引用委托类的语句之前与之后进行）
## 五、总结
代理模式虽然实现了调用者与委托类之间的强耦合，但是却增加了代理类与委托类之间的强耦合（在代理类中显式调用委托类的方法），而且增加代理类之后明显会增加处理时间，拖慢处理时间。